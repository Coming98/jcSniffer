# 扫描技术

## 扫描器

扫描器是一种**自动**检测远程或本地主机安全性弱点的**程序**
> 端口通信小程序

扫描器是一把双刃剑: 既可以是完全评估工具也可以是网络漏洞扫描工具

优势: 自动化

### 主要功能

1. 识别目标主机的工作状态: 开机 / 关机
2. 识别目标主机的端口状态: 监听 / 关闭
3. 操作系统的类型和版本
4. 服务程序的类型和版本
5. 分析

### 扫描流程

1. 发现目标主机或网络: 是否存活
> PING 扫描, Traceroute
2. 搜集目标信息
> 操作系统探测, 穿透防火墙探测, 端口扫描(Nmap)
3. 判断或测试系统是否存在安全漏洞
> 漏洞扫描(Eeye, Nessus)

# TCP 扫描

## FIN 扫描

### XMAS 扫描

将六个标志位置为 1

若目标端口开放, 目标主机将不返回任何信息; 
若目标端口关闭, 目标主机将放回 RST;

## SYN | ACK 扫描

## ACK 扫描

向目标主机放松 ACK 数据包

- 如果返回的 RST 数据包的 TTL 值小于或等于 64, 则端口开放, 否则端口关闭
> TTL 表示包的生存时间

## 
  
# 认证扫描

ident 协议一般用于网络连接过程中服务端验证客户端身份, 监听 TCP 113 端口

## ident 协议过程

1. 客户端向服务器发送 TCP 连接请求
2. 服务器收到请求后先向客户端 TCP 113 端口发送连接请求, 进行客户端的身份验证
3. ident 客户端将通过认证后的客户信息发送给服务器
4. 服务器获得用户信息后进行认证, 认证通过后即可建立 TCP 

## ident 扫描过程

1. 扫描端先主动与目标主机建立 TCP 连接

# FTP 代理扫描

文件传输协议允许数据连接与控制连接位于不同的机器上, 并支持代理 FTP 连接

## FTP 代理扫描过程

使用支持代理的 FTP 服务器来扫描 TCP 端口, 又称为 FTP 反弹扫描

1. 扫描端与支持代理的 FTP 服务器建立控制连接
2. 扫描的使用 PORT 命令向 FTP 服务器说明想要扫描的目标机器的 IP 地址和端口号
3. FTP 服务器会尝试向目标主机指定端口发起数据连接请求
4. 如果目标主机对应端口确实处于监听状态, FTP 就会像扫描端返回成功信息

# 主动协议栈指纹识别

# 被动协议栈指纹识别

不主动发送数据包, 通过被动的捕获远程主机返回的包来分析器 OS 类型版本, 一般可以从 4 个反面着手

1. TTL 值
2. Windows Size
3. DF: 查看操作系统是否设置了不准分片位
4. TOS: 操作系统是否设置了服务类型

# 漏洞扫描

主要以两种方法检查目标主机是否存在漏洞

## 基于漏洞库的特征匹配

端口扫描得知目标主机

漏洞扫描: 大体包括 CGI 漏洞扫描, POP3 漏洞扫描, FTP 漏洞扫描, SSH 漏洞扫描, HTTP 漏洞扫描, 

## 基于模拟攻击

将模拟攻击的模块做成插件的形式, 

## 扫描工具

## SATAN 概论

# 防火墙技术

允许内部网接入外部网络, 但同时能识别和抵抗非授权访问的网络技术

目标: 在内部、外部两个网络之间建立一个安全控制点, 实现对进出内部网络的服务和访问的审计和控制

## 审计技术

日志审计查错